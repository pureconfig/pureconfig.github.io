<html><head><title>PureConfig: Combinators</title><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="com.github.pureconfig" /><meta name="description" content="A boilerplate-free library for loading configuration files" /><meta name="og:image" content="/img/poster.png" /><meta name="og:title" content="PureConfig: Combinators" /><meta name="og:site_name" content="PureConfig" /><meta name="og:url" content="https://pureconfig.github.io/" /><meta name="og:type" content="website" /><meta name="og:description" content="A boilerplate-free library for loading configuration files" /><link rel="icon" type="image/png" href="/img/favicon.png" /><meta name="twitter:title" content="PureConfig: Combinators" /><meta name="twitter:image" content="https://pureconfig.github.io/img/poster.png" /><meta name="twitter:description" content="A boilerplate-free library for loading configuration files" /><meta name="twitter:card" content="summary_large_image" /><link rel="icon" type="image/png" sizes="16x16" href="/img/favicon16x16.png" /><link rel="icon" type="image/png" sizes="24x24" href="/img/favicon24x24.png" /><link rel="icon" type="image/png" sizes="32x32" href="/img/favicon32x32.png" /><link rel="icon" type="image/png" sizes="48x48" href="/img/favicon48x48.png" /><link rel="icon" type="image/png" sizes="57x57" href="/img/favicon57x57.png" /><link rel="icon" type="image/png" sizes="60x60" href="/img/favicon60x60.png" /><link rel="icon" type="image/png" sizes="64x64" href="/img/favicon64x64.png" /><link rel="icon" type="image/png" sizes="70x70" href="/img/favicon70x70.png" /><link rel="icon" type="image/png" sizes="72x72" href="/img/favicon72x72.png" /><link rel="icon" type="image/png" sizes="76x76" href="/img/favicon76x76.png" /><link rel="icon" type="image/png" sizes="96x96" href="/img/favicon96x96.png" /><link rel="icon" type="image/png" sizes="114x114" href="/img/favicon114x114.png" /><link rel="icon" type="image/png" sizes="120x120" href="/img/favicon120x120.png" /><link rel="icon" type="image/png" sizes="128x128" href="/img/favicon128x128.png" /><link rel="icon" type="image/png" sizes="144x144" href="/img/favicon144x144.png" /><link rel="icon" type="image/png" sizes="150x150" href="/img/favicon150x150.png" /><link rel="icon" type="image/png" sizes="152x152" href="/img/favicon152x152.png" /><link rel="icon" type="image/png" sizes="196x196" href="/img/favicon196x196.png" /><link rel="icon" type="image/png" sizes="310x310" href="/img/favicon310x310.png" /><link rel="icon" type="image/png" sizes="310x150" href="/img/favicon310x150.png" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" /><link rel="stylesheet" href="/highlight/styles/default.css" /><link rel="stylesheet" href="/css/style.css" /><link rel="stylesheet" href="/css/palette.css" /><link rel="stylesheet" href="/css/codemirror.css" /><link rel="stylesheet" href="/css/custom.css" /></head><body class="docs"><div id="wrapper"><div id="sidebar-wrapper"><ul id="sidebar" class="sidebar-nav"><li class="sidebar-brand"><a href="/" class="brand"><div class="brand-wrapper"><span>PureConfig</span></div></a></li> <li><a href="/docs/index.html" class="">Quick Start</a></li> <li><a href="/docs/built-in-supported-types.html" class="">Built-in Supported Types</a></li> <li><a href="/docs/supporting-new-types.html" class="">Supporting New Types</a> <ul class="sub_section"> <li><a href="/docs/combinators.html" class=" active ">Combinators</a></li> <li><a href="/docs/config-cursors.html" class="">Config Cursors</a></li> <li><a href="/docs/complex-types.html" class="">Complex Types</a></li></ul></li> <li><a href="/docs/overriding-behavior-for-types.html" class="">Overriding Behavior for Types</a> <ul class="sub_section"> <li><a href="/docs/overriding-behavior-for-case-classes.html" class="">Case Classes</a></li> <li><a href="/docs/overriding-behavior-for-sealed-families.html" class="">Sealed Families</a></li></ul></li> <li><a href="/docs/configurable-converters.html" class="">Configurable Converters</a></li> <li><a href="/docs/error-handling.html" class="">Error Handling</a></li> <li><a href="/docs/config-writers.html" class="">Config Writers</a></li> <li><a href="/docs/non-automatic-derivation.html" class="">Non-Automatic Derivation</a></li> <li><a href="/docs/library-integrations.html" class="">Library Integrations</a></li> <li><a href="/docs/faq.html" class="">FAQ</a></li></ul></div><div id="page-content-wrapper"><div class="nav"><div class="container-fluid"><div class="row"><div class="col-lg-12"><div class="action-menu pull-left clearfix"><a href="#menu-toggle" id="menu-toggle"><i class="fa fa-bars" aria-hidden="true"></i></a></div><ul class="pull-right"><li id="gh-eyes-item" class="hidden-xs"><a href="https://github.com/pureconfig/pureconfig"><i class="fa fa-eye"></i><span>WATCH<span id="eyes" class="label label-default">--</span></span></a></li><li id="gh-stars-item" class="hidden-xs"><a href="https://github.com/pureconfig/pureconfig"><i class="fa fa-star-o"></i><span>STARS<span id="stars" class="label label-default">--</span></span></a></li><li><a href="#" onclick="shareSiteTwitter('PureConfig A boilerplate-free library for loading configuration files');"><i class="fa fa-twitter"></i></a></li><li><a href="#" onclick="shareSiteFacebook('PureConfig A boilerplate-free library for loading configuration files');"><i class="fa fa-facebook"></i></a></li><li><a href="#" onclick="shareSiteGoogle();"><i class="fa fa-google-plus"></i></a></li></ul></div></div></div></div><div id="content" data-github-owner="pureconfig" data-github-repo="pureconfig"><div class="content-wrapper"><section><h2 id="combinators">Combinators</h2>

<p>The combinators defined in
<a href="https://www.javadoc.io/page/com.github.pureconfig/pureconfig-core_2.12/latest/pureconfig/ConfigReader.html"><code class="highlighter-rouge">ConfigReader</code></a>
provide an easy way to create new <code class="highlighter-rouge">ConfigReader</code> instances by transforming existing ones. They are the simplest solution
for supporting new simple types and for slightly modifying existing implementations, since the amount of boilerplate
required is very small. This section contains some examples of combinators and shows how to work with them in
PureConfig.</p>

<p>The simplest combinator is <code class="highlighter-rouge">map</code>, which simply transforms the result of an existing reader:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nn">com.typesafe.config.ConfigFactory</span>
<span class="k">import</span> <span class="nn">pureconfig._</span>
<span class="k">import</span> <span class="nn">pureconfig.generic.auto._</span>

<span class="k">case</span> <span class="k">class</span> <span class="nc">Conf</span><span class="o">(</span><span class="n">bytes</span><span class="k">:</span> <span class="kt">Vector</span><span class="o">[</span><span class="kt">Byte</span><span class="o">])</span>

<span class="c1">// reads an array of bytes from a string
</span><span class="k">implicit</span> <span class="k">val</span> <span class="n">byteVectorReader</span><span class="k">:</span> <span class="kt">ConfigReader</span><span class="o">[</span><span class="kt">Vector</span><span class="o">[</span><span class="kt">Byte</span><span class="o">]]</span> <span class="k">=</span>
  <span class="nc">ConfigReader</span><span class="o">[</span><span class="kt">String</span><span class="o">].</span><span class="n">map</span><span class="o">(</span><span class="k">_</span><span class="o">.</span><span class="n">getBytes</span><span class="o">.</span><span class="n">toVector</span><span class="o">)</span>
</code></pre></div></div>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">loadConfig</span><span class="o">[</span><span class="kt">Conf</span><span class="o">](</span><span class="nc">ConfigFactory</span><span class="o">.</span><span class="n">parseString</span><span class="o">(</span><span class="s">"""{ bytes = "Hello world" }"""</span><span class="o">))</span>
<span class="c1">// res1: pureconfig.ConfigReader.Result[Conf] = Right(Conf(Vector(72, 101, 108, 108, 111, 32, 119, 111, 114, 108, 100)))
</span></code></pre></div></div>

<p><code class="highlighter-rouge">emap</code> allows users to validate the inputs and provide detailed failures:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nn">pureconfig.error._</span>

<span class="k">case</span> <span class="k">class</span> <span class="nc">Port</span><span class="o">(</span><span class="n">number</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span>
<span class="k">case</span> <span class="k">class</span> <span class="nc">Conf</span><span class="o">(</span><span class="n">port</span><span class="k">:</span> <span class="kt">Port</span><span class="o">)</span>

<span class="c1">// reads a TCP port, validating the number range
</span><span class="k">implicit</span> <span class="k">val</span> <span class="n">portReader</span> <span class="k">=</span> <span class="nc">ConfigReader</span><span class="o">[</span><span class="kt">Int</span><span class="o">].</span><span class="n">emap</span> <span class="o">{</span>
  <span class="k">case</span> <span class="n">n</span> <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">65536</span> <span class="k">=&gt;</span> <span class="nc">Right</span><span class="o">(</span><span class="nc">Port</span><span class="o">(</span><span class="n">n</span><span class="o">))</span>
  <span class="k">case</span> <span class="n">n</span> <span class="k">=&gt;</span> <span class="nc">Left</span><span class="o">(</span><span class="nc">CannotConvert</span><span class="o">(</span><span class="n">n</span><span class="o">.</span><span class="n">toString</span><span class="o">,</span> <span class="s">"Port"</span><span class="o">,</span> <span class="s">"Invalid port number"</span><span class="o">))</span>
<span class="o">}</span>
</code></pre></div></div>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">loadConfig</span><span class="o">[</span><span class="kt">Conf</span><span class="o">](</span><span class="nc">ConfigFactory</span><span class="o">.</span><span class="n">parseString</span><span class="o">(</span><span class="s">"{ port = 8080 }"</span><span class="o">))</span>
<span class="c1">// res3: pureconfig.ConfigReader.Result[Conf] = Right(Conf(Port(8080)))
</span>
<span class="n">loadConfig</span><span class="o">[</span><span class="kt">Conf</span><span class="o">](</span><span class="nc">ConfigFactory</span><span class="o">.</span><span class="n">parseString</span><span class="o">(</span><span class="s">"{ port = -1 }"</span><span class="o">))</span>
<span class="c1">// res4: pureconfig.ConfigReader.Result[Conf] = Left(ConfigReaderFailures(ConvertFailure(CannotConvert(-1,Port,Invalid port number),None,port),List()))
</span></code></pre></div></div>

<p><code class="highlighter-rouge">orElse</code> can be used to provide alternative ways to load a config:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">val</span> <span class="n">csvIntListReader</span> <span class="k">=</span> <span class="nc">ConfigReader</span><span class="o">[</span><span class="kt">String</span><span class="o">].</span><span class="n">map</span><span class="o">(</span><span class="k">_</span><span class="o">.</span><span class="n">split</span><span class="o">(</span><span class="s">","</span><span class="o">).</span><span class="n">map</span><span class="o">(</span><span class="k">_</span><span class="o">.</span><span class="n">toInt</span><span class="o">).</span><span class="n">toList</span><span class="o">)</span>
<span class="k">implicit</span> <span class="k">val</span> <span class="n">intListReader</span> <span class="k">=</span> <span class="nc">ConfigReader</span><span class="o">[</span><span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]].</span><span class="n">orElse</span><span class="o">(</span><span class="n">csvIntListReader</span><span class="o">)</span>

<span class="k">case</span> <span class="k">class</span> <span class="nc">Conf</span><span class="o">(</span><span class="n">list</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">])</span>
</code></pre></div></div>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">loadConfig</span><span class="o">[</span><span class="kt">Conf</span><span class="o">](</span><span class="nc">ConfigFactory</span><span class="o">.</span><span class="n">parseString</span><span class="o">(</span><span class="s">"""{ list = [1,2,3] }"""</span><span class="o">))</span>
<span class="c1">// res5: pureconfig.ConfigReader.Result[Conf] = Right(Conf(List(1, 2, 3)))
</span>
<span class="n">loadConfig</span><span class="o">[</span><span class="kt">Conf</span><span class="o">](</span><span class="nc">ConfigFactory</span><span class="o">.</span><span class="n">parseString</span><span class="o">(</span><span class="s">"""{ list = "4,5,6" }"""</span><span class="o">))</span>
<span class="c1">// res6: pureconfig.ConfigReader.Result[Conf] = Right(Conf(List(4, 5, 6)))
</span></code></pre></div></div>
</section></div></div></div></div><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script><script src="/highlight/highlight.pack.js"></script><script>hljs.configure({languages:['scala','java','bash']});
hljs.initHighlighting();
              </script><script src="/js/main.js"></script></body></html>